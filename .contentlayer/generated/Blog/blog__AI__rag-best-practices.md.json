{
  "title": "RAG 系统最佳实践",
  "date": "2026-01-20T00:00:00.000Z",
  "tags": [
    "LLM",
    "deep-learning"
  ],
  "draft": false,
  "summary": "总结企业级 RAG 系统开发中的经验教训，包括文档分块、向量检索和回答生成优化。",
  "authors": [
    "default"
  ],
  "body": {
    "raw": "\n## 什么是 RAG\n\nRAG (Retrieval-Augmented Generation) 是一种结合检索和生成的技术架构：\n\n1. **检索阶段**：从知识库中找到与问题相关的文档片段\n2. **生成阶段**：将检索结果作为上下文，让 LLM 生成回答\n\n## 核心组件\n\n### 文档分块策略\n\n分块质量直接影响检索效果：\n\n```python\nfrom langchain.text_splitter import RecursiveCharacterTextSplitter\n\nsplitter = RecursiveCharacterTextSplitter(\n    chunk_size=500,\n    chunk_overlap=50,\n    separators=[\"\\n\\n\", \"\\n\", \"。\", \"！\", \"？\"]\n)\n```\n\n**经验教训**：\n\n- 中文场景下，按句子分割比按字符更有效\n- overlap 设置为 chunk_size 的 10% 左右\n- 保留文档结构信息（标题、层级）\n\n### 向量存储选择\n\n| 方案     | 优势           | 适用场景         |\n| -------- | -------------- | ---------------- |\n| Chroma   | 轻量、易用     | 本地开发、小规模 |\n| Milvus   | 高性能、分布式 | 生产环境、大规模 |\n| Pinecone | 全托管         | 快速上线、无运维 |\n\n### 检索优化\n\n混合检索效果最佳：\n\n```python\nfrom langchain.retrievers import EnsembleRetriever\n\n# 语义检索 + 关键词检索\nensemble = EnsembleRetriever(\n    retrievers=[vector_retriever, bm25_retriever],\n    weights=[0.7, 0.3]\n)\n```\n\n## 生产实践\n\n### 评估指标\n\n- **召回率**: 相关文档是否被检索到\n- **准确率**: 回答是否正确\n- **幻觉率**: 是否编造不存在的信息\n\n### 常见问题\n\n1. **检索到但答案不对** → 优化 Prompt\n2. **相关文档检索不到** → 调整分块策略\n3. **回答太啰嗦** → 限制输出长度\n\n## 总结\n\nRAG 不是银弹，需要根据业务场景持续优化。关键是建立完善的评估体系。\n",
    "code": "var Component=(()=>{var p=Object.create;var s=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),b=(a,n)=>{for(var c in n)s(a,c,{get:n[c],enumerable:!0})},i=(a,n,c,r)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let l of u(n))!k.call(a,l)&&l!==c&&s(a,l,{get:()=>n[l],enumerable:!(r=m(n,l))||r.enumerable});return a};var x=(a,n,c)=>(c=a!=null?p(N(a)):{},i(n||!a||!a.__esModule?s(c,\"default\",{value:a,enumerable:!0}):c,a)),f=a=>i(s({},\"__esModule\",{value:!0}),a);var d=g((R,t)=>{t.exports=_jsx_runtime});var y={};b(y,{default:()=>o,frontmatter:()=>v});var e=x(d()),v={title:\"RAG \\u7CFB\\u7EDF\\u6700\\u4F73\\u5B9E\\u8DF5\",date:\"2026-01-20\",tags:[\"LLM\",\"deep-learning\"],draft:!1,summary:\"\\u603B\\u7ED3\\u4F01\\u4E1A\\u7EA7 RAG \\u7CFB\\u7EDF\\u5F00\\u53D1\\u4E2D\\u7684\\u7ECF\\u9A8C\\u6559\\u8BAD\\uFF0C\\u5305\\u62EC\\u6587\\u6863\\u5206\\u5757\\u3001\\u5411\\u91CF\\u68C0\\u7D22\\u548C\\u56DE\\u7B54\\u751F\\u6210\\u4F18\\u5316\\u3002\",authors:[\"default\"]};function h(a){let n={a:\"a\",code:\"code\",h2:\"h2\",h3:\"h3\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...a.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\u4EC0\\u4E48\\u662F-rag\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u4EC0\\u4E48\\u662F-rag\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u4EC0\\u4E48\\u662F RAG\"]}),`\n`,(0,e.jsx)(n.p,{children:\"RAG (Retrieval-Augmented Generation) \\u662F\\u4E00\\u79CD\\u7ED3\\u5408\\u68C0\\u7D22\\u548C\\u751F\\u6210\\u7684\\u6280\\u672F\\u67B6\\u6784\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u68C0\\u7D22\\u9636\\u6BB5\"}),\"\\uFF1A\\u4ECE\\u77E5\\u8BC6\\u5E93\\u4E2D\\u627E\\u5230\\u4E0E\\u95EE\\u9898\\u76F8\\u5173\\u7684\\u6587\\u6863\\u7247\\u6BB5\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u751F\\u6210\\u9636\\u6BB5\"}),\"\\uFF1A\\u5C06\\u68C0\\u7D22\\u7ED3\\u679C\\u4F5C\\u4E3A\\u4E0A\\u4E0B\\u6587\\uFF0C\\u8BA9 LLM \\u751F\\u6210\\u56DE\\u7B54\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"\\u6838\\u5FC3\\u7EC4\\u4EF6\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u6838\\u5FC3\\u7EC4\\u4EF6\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u6838\\u5FC3\\u7EC4\\u4EF6\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u6587\\u6863\\u5206\\u5757\\u7B56\\u7565\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u6587\\u6863\\u5206\\u5757\\u7B56\\u7565\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u6587\\u6863\\u5206\\u5757\\u7B56\\u7565\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5206\\u5757\\u8D28\\u91CF\\u76F4\\u63A5\\u5F71\\u54CD\\u68C0\\u7D22\\u6548\\u679C\\uFF1A\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langchain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"text_splitter \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` RecursiveCharacterTextSplitter\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"splitter \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" RecursiveCharacterTextSplitter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    chunk_size\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"500\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    chunk_overlap\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"50\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    separators\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"\\\\n\\\\n\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\\\\n\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\\u3002\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\\uFF01\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:'\"\\uFF1F\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"\\u7ECF\\u9A8C\\u6559\\u8BAD\"}),\"\\uFF1A\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u4E2D\\u6587\\u573A\\u666F\\u4E0B\\uFF0C\\u6309\\u53E5\\u5B50\\u5206\\u5272\\u6BD4\\u6309\\u5B57\\u7B26\\u66F4\\u6709\\u6548\"}),`\n`,(0,e.jsx)(n.li,{children:\"overlap \\u8BBE\\u7F6E\\u4E3A chunk_size \\u7684 10% \\u5DE6\\u53F3\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u4FDD\\u7559\\u6587\\u6863\\u7ED3\\u6784\\u4FE1\\u606F\\uFF08\\u6807\\u9898\\u3001\\u5C42\\u7EA7\\uFF09\"}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u5411\\u91CF\\u5B58\\u50A8\\u9009\\u62E9\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u5411\\u91CF\\u5B58\\u50A8\\u9009\\u62E9\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u5411\\u91CF\\u5B58\\u50A8\\u9009\\u62E9\"]}),`\n`,(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:\"\\u65B9\\u6848\"}),(0,e.jsx)(n.th,{children:\"\\u4F18\\u52BF\"}),(0,e.jsx)(n.th,{children:\"\\u9002\\u7528\\u573A\\u666F\"})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"Chroma\"}),(0,e.jsx)(n.td,{children:\"\\u8F7B\\u91CF\\u3001\\u6613\\u7528\"}),(0,e.jsx)(n.td,{children:\"\\u672C\\u5730\\u5F00\\u53D1\\u3001\\u5C0F\\u89C4\\u6A21\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"Milvus\"}),(0,e.jsx)(n.td,{children:\"\\u9AD8\\u6027\\u80FD\\u3001\\u5206\\u5E03\\u5F0F\"}),(0,e.jsx)(n.td,{children:\"\\u751F\\u4EA7\\u73AF\\u5883\\u3001\\u5927\\u89C4\\u6A21\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"Pinecone\"}),(0,e.jsx)(n.td,{children:\"\\u5168\\u6258\\u7BA1\"}),(0,e.jsx)(n.td,{children:\"\\u5FEB\\u901F\\u4E0A\\u7EBF\\u3001\\u65E0\\u8FD0\\u7EF4\"})]})]})]}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u68C0\\u7D22\\u4F18\\u5316\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u68C0\\u7D22\\u4F18\\u5316\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u68C0\\u7D22\\u4F18\\u5316\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u6DF7\\u5408\\u68C0\\u7D22\\u6548\\u679C\\u6700\\u4F73\\uFF1A\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-python\",children:(0,e.jsxs)(n.code,{className:\"language-python code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"from\"}),\" langchain\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"retrievers \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"import\"}),` EnsembleRetriever\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\u8BED\\u4E49\\u68C0\\u7D22 + \\u5173\\u952E\\u8BCD\\u68C0\\u7D22\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ensemble \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" EnsembleRetriever\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    retrievers\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"vector_retriever\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" bm25_retriever\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    weights\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0.7\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0.3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h2,{id:\"\\u751F\\u4EA7\\u5B9E\\u8DF5\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u751F\\u4EA7\\u5B9E\\u8DF5\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u751F\\u4EA7\\u5B9E\\u8DF5\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u8BC4\\u4F30\\u6307\\u6807\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u8BC4\\u4F30\\u6307\\u6807\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u8BC4\\u4F30\\u6307\\u6807\"]}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u53EC\\u56DE\\u7387\"}),\": \\u76F8\\u5173\\u6587\\u6863\\u662F\\u5426\\u88AB\\u68C0\\u7D22\\u5230\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u51C6\\u786E\\u7387\"}),\": \\u56DE\\u7B54\\u662F\\u5426\\u6B63\\u786E\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u5E7B\\u89C9\\u7387\"}),\": \\u662F\\u5426\\u7F16\\u9020\\u4E0D\\u5B58\\u5728\\u7684\\u4FE1\\u606F\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u5E38\\u89C1\\u95EE\\u9898\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u5E38\\u89C1\\u95EE\\u9898\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u5E38\\u89C1\\u95EE\\u9898\"]}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u68C0\\u7D22\\u5230\\u4F46\\u7B54\\u6848\\u4E0D\\u5BF9\"}),\" \\u2192 \\u4F18\\u5316 Prompt\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u76F8\\u5173\\u6587\\u6863\\u68C0\\u7D22\\u4E0D\\u5230\"}),\" \\u2192 \\u8C03\\u6574\\u5206\\u5757\\u7B56\\u7565\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u56DE\\u7B54\\u592A\\u5570\\u55E6\"}),\" \\u2192 \\u9650\\u5236\\u8F93\\u51FA\\u957F\\u5EA6\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h2,{id:\"\\u603B\\u7ED3\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u603B\\u7ED3\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u603B\\u7ED3\"]}),`\n`,(0,e.jsx)(n.p,{children:\"RAG \\u4E0D\\u662F\\u94F6\\u5F39\\uFF0C\\u9700\\u8981\\u6839\\u636E\\u4E1A\\u52A1\\u573A\\u666F\\u6301\\u7EED\\u4F18\\u5316\\u3002\\u5173\\u952E\\u662F\\u5EFA\\u7ACB\\u5B8C\\u5584\\u7684\\u8BC4\\u4F30\\u4F53\\u7CFB\\u3002\"})]})}function o(a={}){let{wrapper:n}=a.components||{};return n?(0,e.jsx)(n,{...a,children:(0,e.jsx)(h,{...a})}):h(a)}return f(y);})();\n;return Component;"
  },
  "_id": "blog/AI/rag-best-practices.md",
  "_raw": {
    "sourceFilePath": "blog/AI/rag-best-practices.md",
    "sourceFileName": "rag-best-practices.md",
    "sourceFileDir": "blog/AI",
    "contentType": "markdown",
    "flattenedPath": "blog/AI/rag-best-practices"
  },
  "type": "Blog",
  "readingTime": {
    "text": "2 min read",
    "minutes": 1.82,
    "time": 109200,
    "words": 364
  },
  "slug": "rag-best-practices",
  "path": "blog/AI/rag-best-practices",
  "toc": [
    {
      "value": "什么是 RAG",
      "url": "#什么是-rag",
      "depth": 2
    },
    {
      "value": "核心组件",
      "url": "#核心组件",
      "depth": 2
    },
    {
      "value": "文档分块策略",
      "url": "#文档分块策略",
      "depth": 3
    },
    {
      "value": "向量存储选择",
      "url": "#向量存储选择",
      "depth": 3
    },
    {
      "value": "检索优化",
      "url": "#检索优化",
      "depth": 3
    },
    {
      "value": "生产实践",
      "url": "#生产实践",
      "depth": 2
    },
    {
      "value": "评估指标",
      "url": "#评估指标",
      "depth": 3
    },
    {
      "value": "常见问题",
      "url": "#常见问题",
      "depth": 3
    },
    {
      "value": "总结",
      "url": "#总结",
      "depth": 2
    }
  ],
  "structuredData": {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "RAG 系统最佳实践",
    "datePublished": "2026-01-20T00:00:00.000Z",
    "dateModified": "2026-01-20T00:00:00.000Z",
    "description": "总结企业级 RAG 系统开发中的经验教训，包括文档分块、向量检索和回答生成优化。",
    "url": "https://zhangjian94cn.github.io/blog/rag-best-practices"
  }
}