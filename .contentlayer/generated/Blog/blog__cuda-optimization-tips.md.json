{
  "title": "CUDA 性能优化技巧",
  "date": "2026-01-15T00:00:00.000Z",
  "tags": [
    "CUDA",
    "HPC",
    "性能优化",
    "GPU"
  ],
  "draft": false,
  "summary": "深入探讨 CUDA 编程中的性能优化策略，包括内存访问模式、线程组织和性能分析工具。",
  "authors": [
    "default"
  ],
  "body": {
    "raw": "\n## 为什么需要 CUDA 优化\n\nGPU 并行计算能力强大，但要充分发挥性能需要了解硬件特性。优化得当可以获得 10-100 倍加速。\n\n## 核心优化策略\n\n### 1. 内存合并访问\n\nGPU 内存以 128 字节为单位读取，相邻线程访问相邻内存效率最高：\n\n```cpp\n// ❌ 慢：跨步访问\n__global__ void bad_kernel(float* data, int stride) {\n    int idx = threadIdx.x * stride;\n    float val = data[idx];  // 非合并访问\n}\n\n// ✅ 快：连续访问\n__global__ void good_kernel(float* data) {\n    int idx = threadIdx.x;\n    float val = data[idx];  // 合并访问\n}\n```\n\n### 2. 共享内存使用\n\n共享内存速度比全局内存快 100 倍：\n\n```cpp\n__global__ void matrix_mul(float* A, float* B, float* C) {\n    __shared__ float tile_A[16][16];\n    __shared__ float tile_B[16][16];\n\n    // 分块加载到共享内存\n    tile_A[ty][tx] = A[row * N + tx];\n    tile_B[ty][tx] = B[ty * N + col];\n    __syncthreads();\n\n    // 在共享内存中计算\n    for (int k = 0; k < 16; k++) {\n        sum += tile_A[ty][k] * tile_B[k][tx];\n    }\n}\n```\n\n### 3. 避免分支分歧\n\n同一个 warp 内的线程应执行相同指令：\n\n```cpp\n// ❌ 分支分歧\nif (threadIdx.x % 2 == 0) {\n    // 一半线程执行这里\n} else {\n    // 另一半线程执行这里\n}\n\n// ✅ 无分歧\nint offset = (threadIdx.x % 2) * stride;\ndata[threadIdx.x + offset] = value;\n```\n\n## 性能分析工具\n\n### Nsight Compute\n\n```bash\nncu --target-processes all ./my_cuda_app\n```\n\n关注指标：\n\n- **SM 利用率**: 应 > 80%\n- **内存带宽利用率**: 应 > 60%\n- **Occupancy**: 活跃 warp 比例\n\n### nvprof (旧版)\n\n```bash\nnvprof --print-gpu-trace ./my_cuda_app\n```\n\n## 性能对比\n\n优化前后的矩阵乘法性能：\n\n| 版本        | 耗时   | 加速比 |\n| ----------- | ------ | ------ |\n| CPU 基线    | 1200ms | 1x     |\n| 朴素 CUDA   | 45ms   | 27x    |\n| 共享内存    | 8ms    | 150x   |\n| Tensor Core | 2ms    | 600x   |\n\n## 总结\n\nCUDA 优化需要理解硬件架构。善用性能分析工具，找到瓶颈再针对性优化。\n",
    "code": "var Component=(()=>{var h=Object.create;var l=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),x=(a,n)=>{for(var s in n)l(a,s,{get:n[s],enumerable:!0})},i=(a,n,s,t)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let c of u(n))!k.call(a,c)&&c!==s&&l(a,c,{get:()=>n[c],enumerable:!(t=m(n,c))||t.enumerable});return a};var _=(a,n,s)=>(s=a!=null?h(N(a)):{},i(n||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),f=a=>i(l({},\"__esModule\",{value:!0}),a);var r=g((I,o)=>{o.exports=_jsx_runtime});var y={};x(y,{default:()=>p,frontmatter:()=>b});var e=_(r()),b={title:\"CUDA \\u6027\\u80FD\\u4F18\\u5316\\u6280\\u5DE7\",date:\"2026-01-15\",tags:[\"CUDA\",\"HPC\",\"\\u6027\\u80FD\\u4F18\\u5316\",\"GPU\"],draft:!1,summary:\"\\u6DF1\\u5165\\u63A2\\u8BA8 CUDA \\u7F16\\u7A0B\\u4E2D\\u7684\\u6027\\u80FD\\u4F18\\u5316\\u7B56\\u7565\\uFF0C\\u5305\\u62EC\\u5185\\u5B58\\u8BBF\\u95EE\\u6A21\\u5F0F\\u3001\\u7EBF\\u7A0B\\u7EC4\\u7EC7\\u548C\\u6027\\u80FD\\u5206\\u6790\\u5DE5\\u5177\\u3002\",authors:[\"default\"]};function d(a){let n={a:\"a\",code:\"code\",h2:\"h2\",h3:\"h3\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",table:\"table\",tbody:\"tbody\",td:\"td\",th:\"th\",thead:\"thead\",tr:\"tr\",ul:\"ul\",...a.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981-cuda-\\u4F18\\u5316\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981-cuda-\\u4F18\\u5316\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981 CUDA \\u4F18\\u5316\"]}),`\n`,(0,e.jsx)(n.p,{children:\"GPU \\u5E76\\u884C\\u8BA1\\u7B97\\u80FD\\u529B\\u5F3A\\u5927\\uFF0C\\u4F46\\u8981\\u5145\\u5206\\u53D1\\u6325\\u6027\\u80FD\\u9700\\u8981\\u4E86\\u89E3\\u786C\\u4EF6\\u7279\\u6027\\u3002\\u4F18\\u5316\\u5F97\\u5F53\\u53EF\\u4EE5\\u83B7\\u5F97 10-100 \\u500D\\u52A0\\u901F\\u3002\"}),`\n`,(0,e.jsxs)(n.h2,{id:\"\\u6838\\u5FC3\\u4F18\\u5316\\u7B56\\u7565\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u6838\\u5FC3\\u4F18\\u5316\\u7B56\\u7565\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u6838\\u5FC3\\u4F18\\u5316\\u7B56\\u7565\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"1-\\u5185\\u5B58\\u5408\\u5E76\\u8BBF\\u95EE\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#1-\\u5185\\u5B58\\u5408\\u5E76\\u8BBF\\u95EE\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"1. \\u5185\\u5B58\\u5408\\u5E76\\u8BBF\\u95EE\"]}),`\n`,(0,e.jsx)(n.p,{children:\"GPU \\u5185\\u5B58\\u4EE5 128 \\u5B57\\u8282\\u4E3A\\u5355\\u4F4D\\u8BFB\\u53D6\\uFF0C\\u76F8\\u90BB\\u7EBF\\u7A0B\\u8BBF\\u95EE\\u76F8\\u90BB\\u5185\\u5B58\\u6548\\u7387\\u6700\\u9AD8\\uFF1A\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-cpp\",children:(0,e.jsxs)(n.code,{className:\"language-cpp code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u274C \\u6162\\uFF1A\\u8DE8\\u6B65\\u8BBF\\u95EE\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"__global__ \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"bad_kernel\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" stride\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" threadIdx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" stride\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),\" val \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u975E\\u5408\\u5E76\\u8BBF\\u95EE\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u2705 \\u5FEB\\uFF1A\\u8FDE\\u7EED\\u8BBF\\u95EE\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"__global__ \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"good_kernel\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" idx \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" threadIdx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"x\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),\" val \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"idx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u5408\\u5E76\\u8BBF\\u95EE\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h3,{id:\"2-\\u5171\\u4EAB\\u5185\\u5B58\\u4F7F\\u7528\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#2-\\u5171\\u4EAB\\u5185\\u5B58\\u4F7F\\u7528\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"2. \\u5171\\u4EAB\\u5185\\u5B58\\u4F7F\\u7528\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5171\\u4EAB\\u5185\\u5B58\\u901F\\u5EA6\\u6BD4\\u5168\\u5C40\\u5185\\u5B58\\u5FEB 100 \\u500D\\uFF1A\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-cpp\",children:(0,e.jsxs)(n.code,{className:\"language-cpp code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"__global__ \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"void\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"matrix_mul\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" A\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" B\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" C\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    __shared__ \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),\" tile_A\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    __shared__ \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"float\"}),\" tile_B\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u5206\\u5757\\u52A0\\u8F7D\\u5230\\u5171\\u4EAB\\u5185\\u5B58\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    tile_A\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"ty\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"tx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" A\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"row \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" N \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" tx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    tile_B\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"ty\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"tx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" B\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"ty \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" N \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" col\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token function\",children:\"__syncthreads\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u5728\\u5171\\u4EAB\\u5185\\u5B58\\u4E2D\\u8BA1\\u7B97\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"for\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" k \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" k \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"<\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"16\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" k\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"++\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        sum \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+=\"}),\" tile_A\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"ty\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"k\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" tile_B\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"k\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"tx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h3,{id:\"3-\\u907F\\u514D\\u5206\\u652F\\u5206\\u6B67\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#3-\\u907F\\u514D\\u5206\\u652F\\u5206\\u6B67\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"3. \\u907F\\u514D\\u5206\\u652F\\u5206\\u6B67\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u540C\\u4E00\\u4E2A warp \\u5185\\u7684\\u7EBF\\u7A0B\\u5E94\\u6267\\u884C\\u76F8\\u540C\\u6307\\u4EE4\\uFF1A\"}),`\n`,(0,e.jsx)(n.pre,{className:\"language-cpp\",children:(0,e.jsxs)(n.code,{className:\"language-cpp code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u274C \\u5206\\u652F\\u5206\\u6B67\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"if\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"threadIdx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"==\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u4E00\\u534A\\u7EBF\\u7A0B\\u6267\\u884C\\u8FD9\\u91CC\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"else\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u53E6\\u4E00\\u534A\\u7EBF\\u7A0B\\u6267\\u884C\\u8FD9\\u91CC\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// \\u2705 \\u65E0\\u5206\\u6B67\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"int\"}),\" offset \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"threadIdx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"%\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"*\"}),\" stride\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"data\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"threadIdx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),\"x \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"+\"}),\" offset\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" value\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,e.jsxs)(n.h2,{id:\"\\u6027\\u80FD\\u5206\\u6790\\u5DE5\\u5177\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u6027\\u80FD\\u5206\\u6790\\u5DE5\\u5177\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u6027\\u80FD\\u5206\\u6790\\u5DE5\\u5177\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"nsight-compute\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#nsight-compute\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Nsight Compute\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`ncu --target-processes all ./my_cuda_app\n`})})}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5173\\u6CE8\\u6307\\u6807\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"SM \\u5229\\u7528\\u7387\"}),\": \\u5E94 > 80%\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"\\u5185\\u5B58\\u5E26\\u5BBD\\u5229\\u7528\\u7387\"}),\": \\u5E94 > 60%\"]}),`\n`,(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.strong,{children:\"Occupancy\"}),\": \\u6D3B\\u8DC3 warp \\u6BD4\\u4F8B\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"nvprof-\\u65E7\\u7248\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#nvprof-\\u65E7\\u7248\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"nvprof (\\u65E7\\u7248)\"]}),`\n`,(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsx)(n.span,{className:\"code-line\",children:`nvprof --print-gpu-trace ./my_cuda_app\n`})})}),`\n`,(0,e.jsxs)(n.h2,{id:\"\\u6027\\u80FD\\u5BF9\\u6BD4\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u6027\\u80FD\\u5BF9\\u6BD4\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u6027\\u80FD\\u5BF9\\u6BD4\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4F18\\u5316\\u524D\\u540E\\u7684\\u77E9\\u9635\\u4E58\\u6CD5\\u6027\\u80FD\\uFF1A\"}),`\n`,(0,e.jsxs)(n.table,{children:[(0,e.jsx)(n.thead,{children:(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.th,{children:\"\\u7248\\u672C\"}),(0,e.jsx)(n.th,{children:\"\\u8017\\u65F6\"}),(0,e.jsx)(n.th,{children:\"\\u52A0\\u901F\\u6BD4\"})]})}),(0,e.jsxs)(n.tbody,{children:[(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"CPU \\u57FA\\u7EBF\"}),(0,e.jsx)(n.td,{children:\"1200ms\"}),(0,e.jsx)(n.td,{children:\"1x\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"\\u6734\\u7D20 CUDA\"}),(0,e.jsx)(n.td,{children:\"45ms\"}),(0,e.jsx)(n.td,{children:\"27x\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"\\u5171\\u4EAB\\u5185\\u5B58\"}),(0,e.jsx)(n.td,{children:\"8ms\"}),(0,e.jsx)(n.td,{children:\"150x\"})]}),(0,e.jsxs)(n.tr,{children:[(0,e.jsx)(n.td,{children:\"Tensor Core\"}),(0,e.jsx)(n.td,{children:\"2ms\"}),(0,e.jsx)(n.td,{children:\"600x\"})]})]})]}),`\n`,(0,e.jsxs)(n.h2,{id:\"\\u603B\\u7ED3\",className:\"content-header\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\u603B\\u7ED3\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u603B\\u7ED3\"]}),`\n`,(0,e.jsx)(n.p,{children:\"CUDA \\u4F18\\u5316\\u9700\\u8981\\u7406\\u89E3\\u786C\\u4EF6\\u67B6\\u6784\\u3002\\u5584\\u7528\\u6027\\u80FD\\u5206\\u6790\\u5DE5\\u5177\\uFF0C\\u627E\\u5230\\u74F6\\u9888\\u518D\\u9488\\u5BF9\\u6027\\u4F18\\u5316\\u3002\"})]})}function p(a={}){let{wrapper:n}=a.components||{};return n?(0,e.jsx)(n,{...a,children:(0,e.jsx)(d,{...a})}):d(a)}return f(y);})();\n;return Component;"
  },
  "_id": "blog/cuda-optimization-tips.md",
  "_raw": {
    "sourceFilePath": "blog/cuda-optimization-tips.md",
    "sourceFileName": "cuda-optimization-tips.md",
    "sourceFileDir": "blog",
    "contentType": "markdown",
    "flattenedPath": "blog/cuda-optimization-tips"
  },
  "type": "Blog",
  "readingTime": {
    "text": "3 min read",
    "minutes": 2.225,
    "time": 133500,
    "words": 445
  },
  "slug": "cuda-optimization-tips",
  "path": "blog/cuda-optimization-tips",
  "toc": [
    {
      "value": "为什么需要 CUDA 优化",
      "url": "#为什么需要-cuda-优化",
      "depth": 2
    },
    {
      "value": "核心优化策略",
      "url": "#核心优化策略",
      "depth": 2
    },
    {
      "value": "1. 内存合并访问",
      "url": "#1-内存合并访问",
      "depth": 3
    },
    {
      "value": "2. 共享内存使用",
      "url": "#2-共享内存使用",
      "depth": 3
    },
    {
      "value": "3. 避免分支分歧",
      "url": "#3-避免分支分歧",
      "depth": 3
    },
    {
      "value": "性能分析工具",
      "url": "#性能分析工具",
      "depth": 2
    },
    {
      "value": "Nsight Compute",
      "url": "#nsight-compute",
      "depth": 3
    },
    {
      "value": "nvprof (旧版)",
      "url": "#nvprof-旧版",
      "depth": 3
    },
    {
      "value": "性能对比",
      "url": "#性能对比",
      "depth": 2
    },
    {
      "value": "总结",
      "url": "#总结",
      "depth": 2
    }
  ],
  "structuredData": {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "CUDA 性能优化技巧",
    "datePublished": "2026-01-15T00:00:00.000Z",
    "dateModified": "2026-01-15T00:00:00.000Z",
    "description": "深入探讨 CUDA 编程中的性能优化策略，包括内存访问模式、线程组织和性能分析工具。",
    "url": "https://zhangjian94cn.github.io/blog/cuda-optimization-tips"
  }
}